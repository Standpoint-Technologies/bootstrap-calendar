/*! bootstrap-calendar - v0.2.6 - 2015-03-09 - https://github.com/Standpoint-Technologies/bootstrap-calendar */
"use strict";Array.prototype.find||(Array.prototype.find=function(a){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof a)throw new TypeError("predicate must be a function");for(var b,c=Object(this),d=c.length>>>0,e=arguments[1],f=0;d>f;f++)if(b=c[f],a.call(e,b,f,c))return b;return void 0}),Array.prototype.reduce||(Array.prototype.reduce=function(a){if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");var b,c=Object(this),d=c.length>>>0,e=0;if(2==arguments.length)b=arguments[1];else{for(;d>e&&!e in c;)e++;if(e>=d)throw new TypeError("Reduce of empty array with no initial value");b=c[e++]}for(;d>e;e++)e in c&&(b=a(b,c[e],e,c));return b}),Date.prototype.getWeek=function(){var a=new Date(this.getFullYear(),0,1);return Math.ceil(((this.getTime()-a.getTime())/864e5+a.getDay()+1)/7)},Date.prototype.getMonthFormatted=function(){var a=this.getMonth()+1;return 10>a?"0"+a:a},Date.prototype.getDateFormatted=function(){var a=this.getDate();return 10>a?"0"+a:a},String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return"undefined"!=typeof a[c]?a[c]:b})}),String.prototype.formatNum||(String.prototype.formatNum=function(a){for(var b=""+this;b.length<a;)b="0"+b;return b}),function(a){function b(a,b){var c=a;return c=c.replace("%FROM%",b.from),c=c.replace("%TO%",b.to),c=c.replace("%BROWSER_TIMEZONE%",b.browser_timezone)}function c(b,c){var d=null!=b.options[c]?b.options[c]:null,e=null!=b.locale[c]?b.locale[c]:null;if("holidays"==c&&b.options.merge_holidays){var f={};return a.extend(!0,f,e?e:j.holidays),d&&a.extend(!0,f,d),f}return null!=d?d:null!=e?e:j[c]}function d(b,f){var g=[],i=c(b,"holidays");for(var j in i)g.push(j+":"+i[j]);if(g.push(f),g=g.join("|"),g in d.cache)return d.cache[g];var k=[];return a.each(i,function(b,c){var d=null,g=null,i=!1;if(a.each(b.split(">"),function(a,c){var j,k=null;if(j=/^(\d\d)-(\d\d)$/.exec(c))k=new Date(f,parseInt(j[2],10)-1,parseInt(j[1],10));else if(j=/^(\d\d)-(\d\d)-(\d\d\d\d)$/.exec(c))parseInt(j[3],10)==f&&(k=new Date(f,parseInt(j[2],10)-1,parseInt(j[1],10)));else if(j=/^easter(([+\-])(\d+))?$/.exec(c))k=h(f,j[1]?parseInt(j[1],10):0);else if(j=/^(\d\d)([+\-])([1-5])\*([0-6])$/.exec(c)){var l=parseInt(j[1],10)-1,m=j[2],n=parseInt(j[3]),o=parseInt(j[4]);switch(m){case"+":for(var p=new Date(f,l,-6);p.getDay()!=o;)p=new Date(p.getFullYear(),p.getMonth(),p.getDate()+1);k=new Date(p.getFullYear(),p.getMonth(),p.getDate()+7*n);break;case"-":for(var p=new Date(f,l+1,7);p.getDay()!=o;)p=new Date(p.getFullYear(),p.getMonth(),p.getDate()-1);k=new Date(p.getFullYear(),p.getMonth(),p.getDate()-7*n)}}if(!k)return e("Unknown holiday: "+b),i=!0,!1;switch(a){case 0:d=k;break;case 1:if(k.getTime()<=d.getTime())return e("Unknown holiday: "+b),i=!0,!1;g=k;break;default:return e("Unknown holiday: "+b),i=!0,!1}}),!i){var j=[];if(g)for(var l=new Date(d.getTime());l.getTime()<=g.getTime();l.setDate(l.getDate()+1))j.push(new Date(l.getTime()));else j.push(d);k.push({name:c,days:j})}}),d.cache[g]=k,d.cache[g]}function e(b){"object"==a.type(window.console)&&"function"==a.type(window.console.warn)&&window.console.warn("[Bootstrap-Calendar] "+b)}function f(b,c){return this.options=a.extend(!0,{position:{start:moment(new Date),end:moment(new Date)}},i,b),this.setLanguage(this.options.language),this.context=c,c.css("width",this.options.width).addClass("cal-context"),this.view(),a(c).data("bs-calendar",this),this}function g(b,c,d,e){b.stopPropagation();var c=a(c),f=c.closest(".cal-cell"),g=f.closest(".cal-before-eventlist"),h=f.data("cal-row");c.fadeOut("fast"),d.slideUp("fast",function(){var b=a(".events-list",f);d.html(e.options.templates["events-list"]({cal:e,events:e.getEventsBetween(parseInt(b.data("cal-start")),parseInt(b.data("cal-end")))})),g.after(d),e.activecell=a("[data-cal-date]",f).text(),a("#cal-slide-tick").addClass("tick"+h).show(),d.slideDown("fast",function(){a("body").one("click",function(){d.slideUp("fast"),e.activecell=0})})}),setTimeout(function(){a("a.event-item").mouseenter(function(){a('a[data-event-id="'+a(this).data("event-id")+'"]').closest(".cal-cell1").addClass("day-highlight dh-"+a(this).data("event-class"))}),a("a.event-item").mouseleave(function(){a("div.cal-cell1").removeClass("day-highlight dh-"+a(this).data("event-class"))}),e._update_modal()},400)}function h(a,b){var c=a%19,d=Math.floor(a/100),e=a%100,f=Math.floor(d/4),g=d%4,h=Math.floor((d+8)/25),i=Math.floor((d-h+1)/3),j=(19*c+d-f-i+15)%30,k=Math.floor(e/4),l=e%4,m=(32+2*g+2*k-j-l)%7,n=Math.floor((c+11*j+22*m)/451),o=j+m+7*n+114,p=Math.floor(o/31)-1,q=o%31+1;return new Date(a,p,q+(b?b:0),0,0,0)}var i={width:"100%",view:"month",day:"now",time_start:"06:00",time_end:"22:00",time_split:"30",events_source:"",classes:{months:{inmonth:"cal-day-inmonth",outmonth:"cal-day-outmonth",saturday:"cal-day-weekend",sunday:"cal-day-weekend",holidays:"cal-day-holiday",today:"cal-day-today"},week:{workday:"cal-day-workday",saturday:"cal-day-weekend",sunday:"cal-day-weekend",holidays:"cal-day-holiday",today:"cal-day-today"}},modal:null,modal_type:"iframe",modal_title:null,views:{year:{slide_events:!0,enable:!0},month:{slide_events:!0,enable:!0},week:{enable:!0,group:!1},day:{enable:!0,group:!1}},merge_holidays:!1,templates:{day:_.template('<div id="cal-day-box"><div class="row-fluid clearfix cal-row-head"><div class="span1 col-xs-1 cal-cell"><%= cal.locale.time %></div><div class="span11 col-xs-11 cal-cell"><%= cal.locale.events %></div></div><% if(all_day.length) {%><div class="row-fluid clearfix cal-day-hour"><div class="span1 col-xs-1"><b><%= cal.locale.all_day %></b></div><div class="span11 col-xs-11"><% _.each(all_day, function(event){ %><div class="day-highlight dh-<%= event[\'class\'] %>"><a href="<%= event.url ? event.url : \'javascript:void(0)\' %>" data-event-id="<%= event.id %>"data-event-class="<%= event[\'class\'] %>" class="event-item"><%= event.title %></a></div><% }); %></div></div><% }; %><% if(before_time.length) {%><div class="row-fluid clearfix cal-day-hour"><div class="span1 col-xs-3"><b><%= cal.locale.before_time %></b></div><div class="span5 col-xs-5"><% _.each(before_time, function(event){ %><div class="day-highlight dh-<%= event[\'class\'] %>"><span class="cal-hours pull-right"><%= event.end_hour %></span><a href="<%= event.url ? event.url : \'javascript:void(0)\' %>" data-event-id="<%= event.id %>"data-event-class="<%= event[\'class\'] %>" class="event-item"><%= event.title %></a></div><% }); %></div></div><% }; %><div id="cal-day-panel" class="clearfix"><div id="cal-day-panel-hour"><% for(i = 0; i < hours; i++){ %><div class="cal-day-hour"><% for(l = 0; l < cal._hour_min(i); l++){ %><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b><%= cal._hour(i, l) %></b></div><div class="span11 col-xs-11"></div></div><% }; %></div><% }; %></div><% _.each(by_hour, function(event){ %><div class="pull-left day-event day-highlight dh-<%= event[\'class\'] %>" style="margin-top: <%= (event.top * 30) %>px; height: <%= (event.lines * 30) %>px"><span class="cal-hours"><%= event.start_hour %> - <%= event.end_hour %></span><a href="<%= event.url ? event.url : \'javascript:void(0)\' %>" data-event-id="<%= event.id %>"data-event-class="<%= event[\'class\'] %>" class="event-item"><%= event.title %></a></div><% }); %></div><% if(after_time.length) {%><div class="row-fluid clearfix cal-day-hour"><div class="span1 col-xs-3"><b><%= cal.locale.after_time %></b></div><div class="span11 col-xs-9"><% _.each(after_time, function(event){ %><div class="day-highlight dh-<%= event[\'class\'] %>"><span class="cal-hours"><%= event.start_hour %></span><a href="<%= event.url ? event.url : \'javascript:void(0)\' %>" data-event-id="<%= event.id %>"data-event-class="<%= event[\'class\'] %>" class="event-item"><%= event.title %></a></div><% }); %></div></div><% }; %></div>'),"events-list":_.template('<span id="cal-slide-tick" style="display: none"></span><div id="cal-slide-content" class="cal-event-list"><ul class="unstyled list-unstyled"><% _.each(events, function(event) { %><li><span class="pull-left event <%= event[\'class\'] %>"></span>&nbsp;<a href="<%= event.url ? event.url : \'javascript:void(0)\' %>" data-event-id="<%= event.id %>"data-event-class="<%= event[\'class\'] %>" class="event-item"><%= event.title %></a></li><% }) %></ul></div>'),modal:_.template('<% 	event.date_start = new Date(parseInt(event.start));event.date_end = new Date(parseInt(event.end)); %><div id = "event-meta" class  = "pull-right"><span>Starts on <%= event.date_start.date() %> <%= calendar.locale["m" + event.date_start.month()] %> <%= event.date_start.year() %>, at <%= event.date_start.format(\'hh:mm\') %> <i class = "icon-time"></i></span><br /><span>Ends on <%= event.date_end.date() %> <%= calendar.locale["m" + event.date_end.month()] %> <%= event.date_end.year() %> at <%= event.date_end.format(\'hh:mm\') %> <i class = "icon-time"></i></span><br /></div><div style = "margin: 10px 0"><a href = "<%= event.url %>" class = "btn btn-primary"><i class = "icon-calendar"></i> More info</a></div>'),month:_.template('<div class="cal-row-fluid cal-row-head"><% _.each(days_name, function(name){ %><div class="cal-cell1"><%= name %></div><% }) %></div><div class="cal-month-box"><% for(i = 0; i < 6; i++) { %><% if(cal.stop_cycling == true) break; %><div class="cal-row-fluid cal-before-eventlist"><div class="cal-cell1 cal-cell" data-cal-row="-day1"><%= cal._day(i, day++) %></div><div class="cal-cell1 cal-cell" data-cal-row="-day2"><%= cal._day(i, day++) %></div><div class="cal-cell1 cal-cell" data-cal-row="-day3"><%= cal._day(i, day++) %></div><div class="cal-cell1 cal-cell" data-cal-row="-day4"><%= cal._day(i, day++) %></div><div class="cal-cell1 cal-cell" data-cal-row="-day5"><%= cal._day(i, day++) %></div><div class="cal-cell1 cal-cell" data-cal-row="-day6"><%= cal._day(i, day++) %></div><div class="cal-cell1 cal-cell" data-cal-row="-day7"><%= cal._day(i, day++) %></div></div><% } %></div>'),"month-day":_.template('<div class="cal-month-day <%= cls %>"><span class="pull-right" data-cal-date="<%= data_day %>" data-cal-view="day" data-toggle="tooltip" title="<%= tooltip %>"><%= day %></span><% if (events.length > 0) { %><div class="events-list" data-cal-start="<%= start %>" data-cal-end="<%= end %>"><% _.each(events, function(event) { %><a href="<%= event.url ? event.url : \'javascript:void(0)\' %>" data-event-id="<%= event.id %>" data-event-class="<%= event[\'class\'] %>"class="pull-left event <%= event[\'class\'] %>" data-toggle="tooltip"title="<%= event.title %>"></a><% }); %></div><% } %></div>'),week:_.template('<div class="cal-week-box"><div class="cal-offset1 cal-column"></div><div class="cal-offset2 cal-column"></div><div class="cal-offset3 cal-column"></div><div class="cal-offset4 cal-column"></div><div class="cal-offset5 cal-column"></div><div class="cal-offset6 cal-column"></div><div class="cal-row-fluid cal-row-head"><% _.each(days_name, function(name) { %><div class="cal-cell1 <%= cal._getDayClass(\'week\', start) %>" data-toggle="tooltip" title="<%= cal._getHolidayName(start) %>"><%= name %><br><small><span data-cal-date="<%= start.format(\'YYYY-MM-DD\') %>" data-cal-view="day"><%= start.date() %> <%= cal.locale[\'ms\' + start.month()] %></span></small></div><% start = start.clone().date(start.date() + 1); %><% }) %></div><hr><%= cal._week() %></div>'),"week-days":_.template('<% for (var group in events) { %><div class="group event-info"><%= group%></div><% _.each(events[group], function(event){ %><div class="cal-row-fluid"><div class="cal-cell<%= event.days%> cal-offset<%= event.start_day %> day-highlight dh-<%= event[\'class\'] %>" data-event-class="<%= event[\'class\'] %>"><a href="<%= event.url ? event.url : \'javascript:void(0)\' %>" data-event-id="<%= event.id %>" class="cal-event-week event<%= event.id %>"><%= event.title %></a></div></div><% }); %><% } %>'),year:_.template('<div class="cal-year-box"><div class="row row-fluid cal-before-eventlist"><div class="span3 col-md-3 cal-cell" data-cal-row="-month1"><%= cal._month(0) %></div><div class="span3 col-md-3 cal-cell" data-cal-row="-month2"><%= cal._month(1) %></div><div class="span3 col-md-3 cal-cell" data-cal-row="-month3"><%= cal._month(2) %></div><div class="span3 col-md-3 cal-cell" data-cal-row="-month4"><%= cal._month(3) %></div></div><div class="row row-fluid cal-before-eventlist"><div class="span3 col-md-3 cal-cell" data-cal-row="-month1"><%= cal._month(4) %></div><div class="span3 col-md-3 cal-cell" data-cal-row="-month2"><%= cal._month(5) %></div><div class="span3 col-md-3 cal-cell" data-cal-row="-month3"><%= cal._month(6) %></div><div class="span3 col-md-3 cal-cell" data-cal-row="-month4"><%= cal._month(7) %></div></div><div class="row row-fluid cal-before-eventlist"><div class="span3 col-md-3 cal-cell" data-cal-row="-month1"><%= cal._month(8) %></div><div class="span3 col-md-3 cal-cell" data-cal-row="-month2"><%= cal._month(9) %></div><div class="span3 col-md-3 cal-cell" data-cal-row="-month3"><%= cal._month(10) %></div><div class="span3 col-md-3 cal-cell" data-cal-row="-month4"><%= cal._month(11) %></div></div></div>'),"year-month":_.template('<span class="pull-right" data-cal-date="<%= data_day %>" data-cal-view="month"><%= month_name %></span><% if (events.length > 0) { %><small class="cal-events-num badge badge-important pull-left"><%= events.length %></small><div class="hide events-list" data-cal-start="<%= start %>" data-cal-end="<%= end %>"><% _.each(events, function(event) { %><a href="<%= event.url ? event.url : \'javascript:void(0)\' %>" data-event-id="<%= event.id %>" data-event-class="<%= event[\'class\'] %>" class="pull-left event <%= event[\'class\'] %> event<%= event.id %>" data-toggle="tooltip" title="<%= event.title %>"></a><% }); %></div><% } %>')},events:[],stop_cycling:!1,week_hover:!0,week_vertical:!1},j={first_day:2,holidays:{"01-01":"New Year's Day","01+3*1":"Birthday of Dr. Martin Luther King, Jr.","02+3*1":"Washington's Birthday","05-1*1":"Memorial Day","04-07":"Independence Day","09+1*1":"Labor Day","10+2*1":"Columbus Day","11-11":"Veterans Day","11+4*4":"Thanksgiving Day","25-12":"Christmas"}},k={error_noview:"Calendar: View {0} not found",error_dateformat:'Calendar: Wrong date format {0}. Should be either "now" or "yyyy-mm-dd"',error_loadurl:"Calendar: Event URL is not set",error_where:'Calendar: Wrong navigation direction {0}. Can be only "next" or "prev" or "today"',error_timedevide:"Calendar: Time split parameter should divide 60 without decimals. Something like 10, 15, 30",no_events_in_day:"No events in this day.",title_year:"{0}",title_month:"{0} {1}",title_week:"week {0} of {1}",title_day:"{0} {1} {2}, {3}",week:"Week {0}",week_vertical:"W<br/>e<br/>e<br/>k<br/><br/>{0}",all_day:"All day",time:"Time",events:"Events",before_time:"Ends before timeline",after_time:"Starts after timeline",m0:"January",m1:"February",m2:"March",m3:"April",m4:"May",m5:"June",m6:"July",m7:"August",m8:"September",m9:"October",m10:"November",m11:"December",ms0:"Jan",ms1:"Feb",ms2:"Mar",ms3:"Apr",ms4:"May",ms5:"Jun",ms6:"Jul",ms7:"Aug",ms8:"Sep",ms9:"Oct",ms10:"Nov",ms11:"Dec",d0:"Sunday",d1:"Monday",d2:"Tuesday",d3:"Wednesday",d4:"Thursday",d5:"Friday",d6:"Saturday"},l=null;try{l=moment().zone()}catch(m){a.error("Error detecting timezone")}d.cache={},f.prototype.reload=function(){this.view()},f.prototype.setOptions=function(b){a.extend(this.options,b),"language"in b&&this.setLanguage(b.language),"modal"in b&&this._update_modal()},f.prototype.setLanguage=function(b){window.calendar_languages&&b in window.calendar_languages?(this.locale=a.extend(!0,{},k,calendar_languages[b]),this.options.language=b):(this.locale=k,delete this.options.language)},f.prototype._render=function(){this.context.empty(),this.stop_cycling=!1;var a={};switch(a.cal=this,a.day=1,a.days_name=1==c(this,"first_day")?[this.locale.d1,this.locale.d2,this.locale.d3,this.locale.d4,this.locale.d5,this.locale.d6,this.locale.d0]:[this.locale.d0,this.locale.d1,this.locale.d2,this.locale.d3,this.locale.d4,this.locale.d5,this.locale.d6],a.events=this.getEventsBetween(this.options.position.start,this.options.position.end),this.options.view){case"month":break;case"week":this._calculate_hour_minutes(a);break;case"day":this._calculate_hour_minutes(a)}a.start=this.options.position.start,a.lang=this.locale,this.context.append(this.options.templates[this.options.view](a)),this._update()},f.prototype._calculate_hour_minutes=function(b){var c=this,d=parseInt(this.options.time_split),f=60/d,g=Math.min(f,1);(f>=1&&f%1!=0||1>f&&1440/d%1!=0)&&a.error(this.locale.error_timedevide);var h=this.options.time_start.split(":"),i=this.options.time_end.split(":");b.hours=(parseInt(i[0])-parseInt(h[0]))*g;var j=b.hours*f-parseInt(h[1])/d,k=6e4*d,l=this.options.position.start.toDate();l.setHours(h[0]),l.setMinutes(h[1]);var m=this.options.position.end.toDate();m.setHours(i[0]),m.setMinutes(i[1]),b.all_day=[],b.by_hour=[],b.after_time=[],b.before_time=[],a.each(b.events,function(a,d){var f=c._convertDateToMoment(d.start).toDate(),g=c._convertDateToMoment(d.end).toDate();if(d.start_hour=f.getHours().toString().formatNum(2)+":"+f.getMinutes().toString().formatNum(2),d.end_hour=g.getHours().toString().formatNum(2)+":"+g.getMinutes().toString().formatNum(2),l>f&&(e(1),d.start_hour=f.getDate()+" "+c.locale["ms"+f.getMonth()]+" "+d.start_hour),g>m&&(e(1),d.end_hour=g.getDate()+" "+c.locale["ms"+g.getMonth()]+" "+d.end_hour),l>f&&g>m)return void b.all_day.push(d);if(l>g)return void b.before_time.push(d);if(f>m)return void b.after_time.push(d);var h=l.getTime()-f.getTime();d.top=h>=0?0:Math.abs(h)/k;var i=Math.abs(j-d.top),n=(g.getTime()-f.getTime())/k;h>=0&&(n=(g.getTime()-l.getTime())/k),d.lines=n,n>i&&(d.lines=i),b.by_hour.push(d)})},f.prototype._hour_min=function(a){var b=this.options.time_start.split(":"),c=parseInt(this.options.time_split),d=60/c;return 0==a?d-parseInt(b[1])/c:d},f.prototype._hour=function(a,b){var c=this.options.time_start.split(":"),d=parseInt(this.options.time_split),e=""+(parseInt(c[0])+a*Math.max(d/60,1)),f=""+(d*b+(0==a?parseInt(c[1]):0));return e.formatNum(2)+":"+f.formatNum(2)},f.prototype._week=function(){var b={},d=this.options.position.start.clone(),e=this.options.position.end.clone(),f=[],g=this,h=c(this,"first_day");return a.each(this.getEventsBetween(d,e),function(a,b){var c=g._convertDateToMoment(b.start),e=g._convertDateToMoment(b.end),i=c.toDate().getTime(),j=e.toDate().getTime();b.start_day=c.day(),1==h&&(b.start_day=(b.start_day+6)%7),b.days=864e5>=j-i?1:(j-i)/864e5,d>i&&(b.days=b.days-(d-i)/864e5,b.start_day=0),b.days=Math.ceil(b.days),b.start_day+b.days>7&&(b.days=7-b.start_day),f.push(b)}),b.events=g.options.views.week.group?this._groupEvents(f):{"":f},b.cal=this,g.options.templates["week-days"](b)},f.prototype._month=function(a){var b={cal:this},c=a+1;return b.data_day=this.options.position.start.year()+"-"+(10>c?"0"+c:c)+"-01",b.month_name=this.locale["m"+a],b.start=moment(new Date(this.options.position.start.year(),a,1,0,0,0)),b.end=moment(new Date(this.options.position.start.year(),a+1,1,0,0,0)),b.events=this.getEventsBetween(b.start,b.end),this.options.templates["year-month"](b)},f.prototype._day=function(b,d){var e={tooltip:"",cal:this},f=this.options.classes.months.outmonth,g=this.options.position.start.day();2==c(this,"first_day")?g++:g=0==g?7:g,d=d-g+1;var h=new Date(this.options.position.start.year(),this.options.position.start.month(),d,0,0,0);d>0&&(f=this.options.classes.months.inmonth);var i=new Date(this.options.position.end.toDate().getTime()-1).getDate();if(d+1>i&&(this.stop_cycling=!0),d>i&&(d-=i,f=this.options.classes.months.outmonth),f=a.trim(f+" "+this._getDayClass("months",moment(h))),0>=d){var j=new Date(this.options.position.start.year(),this.options.position.start.month(),0).getDate();d=j-Math.abs(d),f+=" cal-month-first-row"}var k=this._getHoliday(moment(h));return k!==!1&&(e.tooltip=k),e.data_day=h.getFullYear()+"-"+h.getMonthFormatted()+"-"+(10>d?"0"+d:d),e.cls=f,e.day=d,e.start=moment(h),e.end=e.start.clone().endOf("day"),e.events=this.getEventsBetween(e.start,e.end),this.options.templates["month-day"](e)},f.prototype._getHoliday=function(b){var c=!1;return a.each(d(this,b.year()),function(){var d=!1;return a.each(this.days,function(){return b.isSame(this)?(d=!0,!1):void 0}),d?(c=this.name,!1):void 0}),c},f.prototype._getHolidayName=function(a){var b=this._getHoliday(a);return b===!1?"":b},f.prototype._getDayClass=function(a,b){var c=this,d=function(b,d){var e;e=c.options.classes&&a in c.options.classes&&b in c.options.classes[a]?c.options.classes[a][b]:"","string"==typeof e&&e.length&&d.push(e)},e=[];b.isSame(new Date)&&d("today",e);var f=this._getHoliday(b);switch(f!==!1&&d("holidays",e),b.day()){case 0:d("sunday",e);break;case 6:d("saturday",e)}return d(b.toDate().toDateString(),e),e.join(" ")},f.prototype._groupEvents=function(a){return a.reduce(function(a,b){var c=b.group||"";return a[c]||(a[c]=[]),a[c].push(b),a},{})},f.prototype.view=function(b){var c=this;if(b){if(!c.options.views[b].enable)return;c.options.view=b}c._init_position(),c._loadEvents(function(){c._render(),a(c.context).trigger(a.Event("view-loaded.bs-calendar",{calendar:c,view:c.options.view}))})},f.prototype.navigate=function(b,c){var d=a.extend({},this.options.position);if("next"==b)switch(this.options.view){case"year":d.start.year(this.options.position.start.year()+1);break;case"month":d.start.month(this.options.position.start.month()+1);break;case"week":d.start.date(this.options.position.start.date()+7);break;case"day":d.start.date(this.options.position.start.date()+1)}else if("prev"==b)switch(this.options.view){case"year":d.start.year(this.options.position.start.year()-1);break;case"month":d.start.month(this.options.position.start.month()-1);break;case"week":d.start.date(this.options.position.start.date()-7);break;case"day":d.start.date(this.options.position.start.date()-1)}else"today"==b?d.start=moment():a.error(this.locale.error_where.format(b));this.options.day=d.start.format("YYYY-MM-DD"),this.view(),"function"==typeof c&&c()},f.prototype._init_position=function(){var b,d,e;if("now"==this.options.day){var f=new Date;b=f.getFullYear(),d=f.getMonth(),e=f.getDate()}else if(this.options.day.match(/^\d{4}-\d{2}-\d{2}$/g)){var g=this.options.day.split("-");b=parseInt(g[0],10),d=parseInt(g[1],10)-1,e=parseInt(g[2],10)}else a.error(this.locale.error_dateformat.format(this.options.day));switch(this.options.view){case"year":this.options.position.start=moment(new Date(b,0,1)),this.options.position.end=moment(new Date(b+1,0,1));break;case"month":this.options.position.start=moment(new Date(b,d,1)),this.options.position.end=moment(new Date(b,d+1,1));break;case"day":this.options.position.start=moment(new Date(b,d,e)),this.options.position.end=moment(new Date(b,d,e+1));break;case"week":var h,i=new Date(b,d,e);h=1==c(this,"first_day")?i.getDate()-(i.getDay()+6)%7:i.getDate()-i.getDay(),this.options.position.start=moment(new Date(b,d,h)),this.options.position.end=moment(new Date(b,d,h+7));break;default:a.error(this.locale.error_noview.format(this.options.view))}return this},f.prototype.getTitle=function(){var a=this.options.position.start;switch(this.options.view){case"year":return this.locale.title_year.format(a.year());case"month":return this.locale.title_month.format(this.locale["m"+a.month()],a.year());case"week":return this.locale.title_week.format(a.week(),a.year());case"day":return this.locale.title_day.format(this.locale["d"+a.day()],a.date(),this.locale["m"+a.month()],a.year())}},f.prototype.isToday=function(){var a=moment();return a>this.options.position.start&&a<this.options.position.end},f.prototype.getStartDate=function(){return this.options.position.start.toDate()},f.prototype.getEndDate=function(){return this.options.position.end.toDate()},f.prototype._loadEvents=function(c){var d,e=this,f=this.options.events_source;switch(a.type(f)){case"function":d=function(a){f.call(e,e.options.position.start,e.options.position.end,l,a)};break;case"array":d=function(a){return a([].concat(f))};break;case"string":f.length&&(d=function(c){var d=[],g={from:e.options.position.start.format("MM/DD/YYYY"),to:e.options.position.end.format("MM/DD/YYYY"),browser_timezone:l};l.length&&(g.browser_timezone=l),a.ajax({url:b(f,g),dataType:"json",type:"GET"}).done(function(a){d=a,"function"==typeof c&&c(d)}).fail(function(b,c,d){a.error(d)})})}d||a.error(e.locale.error_loadurl);var g=a.Event("events-loading.bs-calendar",{calendar:e});a(e.context).trigger(g),g.isDefaultPrevented()||d(function(b){e.options.events=b,e.options.events.sort(function(a,b){var c;return isNaN(a.start)?(c=moment(a.start)-moment(b.start),0==c&&(c=moment(a.end)-moment(b.end))):(c=a.start-b.start,0==c&&(c=a.end-b.end)),c}),a(e.context).trigger(a.Event("events-loaded.bs-calendar",{calendar:e,events:e.options.events})),"function"==typeof c&&c.call(e)})},f.prototype._update=function(){var b=this;a('*[data-toggle="tooltip"]').tooltip({container:"body"}),a("*[data-cal-date]").click(function(c){var d=a.Event("calendar.cell.label.click",{originalEvent:c});a(b.context).trigger(d);var e=a(this).data("cal-view");b.options.day=a(this).data("cal-date"),b.view(e)}),a(".cal-cell").dblclick(function(){var c=a("[data-cal-date]",this).data("cal-view");b.options.day=a("[data-cal-date]",this).data("cal-date"),b.view(c)}),this["_update_"+this.options.view](),this._update_modal()},f.prototype._update_modal=function(){var b=this;if(a("a[data-event-id]",this.context).unbind("click"),b.options.modal){var c=a(b.options.modal);if(c.length){var d=null;"iframe"==b.options.modal_type&&(d=a(document.createElement("iframe")).attr({width:"100%",frameborder:"0"})),a("a[data-event-id]",this.context).on("click",function(e,f){f.preventDefault(),f.stopPropagation();var g=a(this).attr("href"),h=a(this).data("event-id"),f=b.options.events.find(function(a){return a.id==h});"iframe"==b.options.modal_type&&(d.attr("src",g),a(".modal-body",c).html(d)),(!c.data("handled.bootstrap-calendar")||c.data("handled.bootstrap-calendar")&&c.data("handled.event-id")!=f.id)&&c.off("show.bs.modal").off("shown.bs.modal").off("hidden.bs.modal").on("show.bs.modal",function(){var d=a(this).find(".modal-body");switch(b.options.modal_type){case"iframe":var e=d.height()-parseInt(d.css("padding-top"),10)-parseInt(d.css("padding-bottom"),10);a(this).find("iframe").height(Math.max(e,50));break;case"ajax":a.ajax({url:g,dataType:"html",async:!1,success:function(a){d.html(a)}});break;case"template":d.html(b.options.templates.modal({event:f,calendar:b}))}"function"==typeof b.options.modal_title&&c.find("h3").html(b.options.modal_title(f))}).on("shown.bs.modal",function(){a(b.context).trigger(a.Event("shown.bs-calendar.modal",{calendar:this,events:b.options.events}))}).on("hidden.bs.modal",function(){a(b.context).trigger(a.Event("hidden.bs-calendar.modal",{calendar:this,events:b.options.events}))}).data("handled.bootstrap-calendar",!0).data("handled.event-id",f.id),c.modal("show")})}}},f.prototype._update_day=function(){a("#cal-day-panel").height(a("#cal-day-panel-hour").height())},f.prototype._update_week=function(){},f.prototype._update_year=function(){this._update_month_year()},f.prototype._update_month=function(){this._update_month_year();var b=this,c=a(document.createElement("div")).attr("id","cal-week-box"),d=this.options.position.start.year()+"-"+this.options.position.start.format("MM")+"-";a(".cal-month-box .cal-row-fluid").on("mouseenter",function(){var e=b.options.position.start.toDate(),f=a(".cal-cell1:first-child .cal-month-day",this),g=f.hasClass("cal-month-first-row")?1:a("[data-cal-date]",f).text().trim();e.setDate(parseInt(g)),g=10>g?"0"+g:g,b.options.week_hover&&(b.options.week_vertical?(c.html(b.locale.week_vertical.format(e.getWeek())),c.addClass("cal-week-box-vertical")):c.html(b.locale.week.format(e.getWeek())),c.attr("data-cal-week",d+g).show().appendTo(f))}).on("mouseleave",function(){c.hide()}),c.click(function(){b.options.day=a(this).data("cal-week"),b.view("week")}),a("a.event").mouseenter(function(){a('a[data-event-id="'+a(this).data("event-id")+'"]').closest(".cal-cell1").addClass("day-highlight dh-"+a(this).data("event-class"))}),a("a.event").mouseleave(function(){a("div.cal-cell1").removeClass("day-highlight dh-"+a(this).data("event-class"))})},f.prototype._update_month_year=function(){if(this.options.views[this.options.view].slide_events){var b=this,c=a(document.createElement("div")).attr("id","cal-day-tick").html('<i class="icon-chevron-down glyphicon glyphicon-chevron-down"></i>');a(".cal-month-day, .cal-year-box .span3").on("mouseenter",function(){0!=a(".events-list",this).length&&a(this).children("[data-cal-date]").text()!=b.activecell&&c.show().appendTo(this)}).on("mouseleave",function(){c.hide()}).on("click",function(e){if(0!=a(".events-list",this).length&&a(this).children("[data-cal-date]").text()!=b.activecell){var f=a.Event("calendar.day.click",{_this:a(this),downbox:c,slider:d,calendar:b});a(b.context).trigger(f),f.isDefaultPrevented()||g(e,c,d,b)}});var d=a(document.createElement("div")).attr("id","cal-slide-box");d.hide().click(function(a){a.stopPropagation()}),c.click(function(c){g(c,a(this),d,b)})}},f.prototype.getEventsBetween=function(b,c){var d=[],e=this;return a.each(e.options.events,function(a,f){if(null==f.start)return!0;var g=e._convertDateToMoment(f.start),h=e._convertDateToMoment(f.end);c>g&&h>=b&&d.push(f)}),d},f.prototype._convertDateToMoment=function(a){return moment(isNaN(a)?a:new Date(parseInt(a)))},a.fn.calendar=function(b){var c=a(this).data("bs-calendar");return c?c:new f(b,this)}}(jQuery);